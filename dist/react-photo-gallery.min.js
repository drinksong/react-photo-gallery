!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react"),require("prop-types"),require("resize-observer-polyfill")):"function"==typeof define&&define.amd?define(["react","prop-types","resize-observer-polyfill"],t):e.Gallery=t(e.React,e.PropTypes,e.ResizeObserver)}(this,function(e,t,r){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t,r=r&&r.hasOwnProperty("default")?r.default:r;!function(){function e(e){this.value=e}function t(t){var r,n;function o(r,n){try{var u=t[r](n),a=u.value;a instanceof e?Promise.resolve(a.value).then(function(e){o("next",e)},function(e){o("throw",e)}):i(u.done?"return":"normal",u.value)}catch(e){i("throw",e)}}function i(e,t){switch(e){case"return":r.resolve({value:t,done:!0});break;case"throw":r.reject(t);break;default:r.resolve({value:t,done:!1})}(r=r.next)?o(r.key,r.arg):n=null}this._invoke=function(e,t){return new Promise(function(i,u){var a={key:e,arg:t,resolve:i,reject:u,next:null};n?n=n.next=a:(r=n=a,o(e,t))})},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}();var n=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},a={cursor:"pointer"},c=function(t){var r=t.index,n=t.onClick,o=t.photo,u=t.margin,c=t.direction,l=t.top,s=t.left,f={margin:u};"column"===c&&(f.position="absolute",f.left=s,f.top=l);return e.createElement("img",i({style:n?i({},f,a):f},o,{onClick:n?function(e){n(e,{photo:o,index:r})}:null}))};t.shape({src:t.string.isRequired,width:t.number.isRequired,height:t.number.isRequired,alt:t.string,title:t.string,srcSet:t.oneOfType([t.string,t.array]),sizes:t.oneOfType([t.string,t.array])});function l(e,t){return t||(t=0),Number(Math.round(e+"e"+t)+"e-"+t)}function s(e){return l(e.width/e.height,2)}var f=function(t){function a(){var e,t,r,o;n(this,a);for(var i=arguments.length,u=Array(i),c=0;c<i;c++)u[c]=arguments[c];return t=r=babelHelpers.possibleConstructorReturn(this,(e=a.__proto__||Object.getPrototypeOf(a)).call.apply(e,[this].concat(u))),r.state={containerWidth:0},r.handleClick=function(e,t,n){var o=t.index,i=r.props,u=i.photos;(0,i.onClick)(e,babelHelpers.extends({index:o,photo:u[o],previous:u[o-1]||null,next:u[o+1]||null},n))},o=t,babelHelpers.possibleConstructorReturn(r,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,e.Component),o(a,[{key:"componentDidMount",value:function(){var e=this;this.observer=new r(function(t){var r=t[0].contentRect.width;e.state.containerWidth!==r&&e.setState({containerWidth:Math.floor(r)})}),this.observer.observe(this._gallery)}},{key:"componentWillUnmount",value:function(){this.observer.disconnect()}},{key:"render",value:function(){var t=this,r=this.state.containerWidth;if(!r)return e.createElement("div",{ref:function(e){return t._gallery=e}});var n=this.props.ImageComponent,o=void 0===n?c:n,a=this.props,f=a.margin,p=a.onClick,h=a.direction,d=this.props.columns;void 0===d&&(d=1,r>=500&&(d=2),r>=900&&(d=3),r>=1500&&(d=4));var v=this.props.photos,y=r-1,m=void 0,g=void 0;return"row"===h&&(m={display:"flex",flexWrap:"wrap",flexDirection:"row"},g=function(e){var t=e.photos,r=e.columns,n=e.width,o=e.margin;if(!n)return[];var a=t.reduce(function(e,t,n){var o=Math.floor(n/r);return e[o]=e[o]?[].concat(u(e[o]),[t]):[t],e},[]),c=[];return a.map(function(e,u){var f=e.reduce(function(e,t){return e+s(t)},0),p=n-e.length*(2*o);u!==a.length-1&&c.push(f);var h=e.length===r?p/f:t.length<r?p/f*(e.length/r):p/(c.reduce(function(e,t){return e+t},0)/(a.length-1));return e.map(function(e){return i({},e,{height:l(h,1),width:l(h*s(e),1)})})}).reduce(function(e,t){return[].concat(u(e),u(t))},[])}({width:y,columns:d,margin:f,photos:v})),"column"===h&&(m={position:"relative"},g=function(e){for(var t=e.photos,r=e.columns,n=e.width,o=e.margin,u=(n-2*o*r)/r,a=t.map(function(e){var t=e.height/e.width*u;return i({},e,{width:l(u,1),height:l(t,1)})}),c=[],s=[],f=0;f<r;f++)c[f]=l(f*(u+2*o),1),s[f]=0;return a.map(function(e){var t=s.reduce(function(e,t,r){return e=t<s[e]?r:e},0);e.top=s[t],e.left=c[t],s[t]=s[t]+e.height+2*o;var r=s.reduce(function(e,t,r){return e=t>s[e]?r:e},0);return e.containerHeight=s[r],e})}({width:y,columns:d,margin:f,photos:v}),m.height=g[g.length-1].containerHeight),e.createElement("div",{className:"react-photo-gallery--gallery"},e.createElement("div",{ref:function(e){return t._gallery=e},style:m},g.map(function(r,n){var i=r.left,u=r.top,a=(r.containerHeight,function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(r,["left","top","containerHeight"]));return e.createElement(o,{key:r.key||r.src,margin:f,index:n,photo:a,direction:h,left:i,top:u,onClick:p?t.handleClick:null})})))}}]),a}();return f.defaultProps={margin:2,direction:"row"},f});
